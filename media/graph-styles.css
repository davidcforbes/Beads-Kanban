/**
 * Dependency Diagram / Graph View Styles
 * Theme-aware styling for graph visualization
 */

/* Main container - horizontal layout with sidebar */
#dependencyDiagram {
  display: flex;
  flex-direction: row;
  height: 100%;
  width: 100%;
  background-color: var(--vscode-editor-background);
}

#dependencyDiagram.hidden {
  display: none;
}

/* Left Sidebar */
.graph-sidebar {
  width: 280px;
  min-width: 280px;
  max-width: 400px;
  display: flex;
  flex-direction: column;
  background-color: var(--vscode-sideBar-background);
  border-right: 1px solid var(--vscode-panel-border);
  overflow: hidden;
}

.graph-sidebar-header {
  padding: 12px 16px;
  border-bottom: 1px solid var(--vscode-panel-border);
  background-color: var(--vscode-sideBarSectionHeader-background);
}

.graph-sidebar-header h3 {
  margin: 0;
  font-size: 11px;
  font-weight: 600;
  color: var(--vscode-sideBarSectionHeader-foreground);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.graph-issue-list {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
}

.graph-issue-item {
  display: grid;
  grid-template-columns: 100px 1fr;
  gap: 8px;
  padding: 6px 16px;
  border-bottom: 1px solid var(--vscode-panel-border);
  cursor: pointer;
  font-size: 12px;
  transition: background-color 0.1s;
}

.graph-issue-item:hover {
  background-color: var(--vscode-list-hoverBackground);
}

.graph-issue-item.selected {
  background-color: var(--vscode-list-activeSelectionBackground);
  color: var(--vscode-list-activeSelectionForeground);
}

.graph-issue-item .issue-id {
  font-family: var(--vscode-editor-font-family);
  font-size: 11px;
  color: var(--vscode-descriptionForeground);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.graph-issue-item .issue-title {
  font-size: 12px;
  color: var(--vscode-foreground);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.graph-issue-item.selected .issue-id,
.graph-issue-item.selected .issue-title {
  color: var(--vscode-list-activeSelectionForeground);
}

/* Main graph area */
.graph-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Graph controls panel */
.graph-controls {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background-color: var(--vscode-sideBar-background);
  border-bottom: 1px solid var(--vscode-panel-border);
  flex-wrap: wrap;
}

.graph-controls-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.graph-controls label {
  font-size: 12px;
  color: var(--vscode-foreground);
  margin: 0;
}

.graph-controls select,
.graph-controls input[type="number"] {
  padding: 4px 8px;
  font-size: 12px;
  background-color: var(--vscode-input-background);
  color: var(--vscode-input-foreground);
  border: 1px solid var(--vscode-input-border);
  border-radius: 2px;
}

.graph-controls input[type="checkbox"] {
  margin: 0;
}

.graph-controls button {
  padding: 4px 12px;
  font-size: 12px;
  background-color: var(--vscode-button-background);
  color: var(--vscode-button-foreground);
  border: none;
  border-radius: 2px;
  cursor: pointer;
}

.graph-controls button:hover {
  background-color: var(--vscode-button-hoverBackground);
}

.graph-controls button.secondary {
  background-color: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
}

.graph-controls button.secondary:hover {
  background-color: var(--vscode-button-secondaryHoverBackground);
}

/* Canvas container with scrollbars */
.graph-canvas-container {
  position: relative;
  flex: 1;
  overflow: auto;
  background-color: var(--vscode-editor-background);
}

/* SVG container */
.graph-svg {
  width: 100%;
  height: 100%;
  background-color: var(--vscode-editor-background);
  user-select: none;
}

/* SVG elements */
.edges-group,
.nodes-group {
  transition: transform 0.1s ease-out;
}

/* Graph nodes */
.graph-node {
  cursor: move;
  transition: opacity 0.2s;
}

.graph-node:hover {
  opacity: 0.95;
}

.graph-node .node-bg {
  stroke-width: 2;
  transition: stroke-width 0.2s, fill 0.2s;
}

.graph-node:hover .node-bg {
  stroke-width: 3;
}

/* Selected node visual feedback */
.graph-node.selected .node-bg {
  stroke-width: 4;
  stroke-dasharray: 8, 4;
}

/* Node status colors - TRANSLUCENT BACKGROUNDS */
.node-bg.status-ready,
.node-bg.status-open {
  fill: #FFD700;
  fill-opacity: 0.4;
  stroke: #FFA500;
  stroke-width: 2;
}

.node-bg.status-in_progress {
  fill: #4CAF50;
  fill-opacity: 0.4;
  stroke: #388E3C;
  stroke-width: 2;
}

.node-bg.status-blocked {
  fill: #F44336;
  fill-opacity: 0.4;
  stroke: #D32F2F;
  stroke-width: 2;
}

.node-bg.status-closed {
  fill: #9E9E9E;
  fill-opacity: 0.3;
  stroke: #757575;
  stroke-width: 2;
}

/* Node text - adjust for colored backgrounds */
.node-title {
  fill: #000000;
  font-size: 13px;
  font-weight: 600;
  pointer-events: none;
}

.node-id {
  fill: #333333;
  font-size: 10px;
  font-family: var(--vscode-editor-font-family);
  pointer-events: none;
}

.node-type {
  fill: #333333;
  font-size: 10px;
  font-style: italic;
  pointer-events: none;
}

.node-warning {
  fill: #FF0000;
  font-size: 16px;
  font-weight: bold;
  pointer-events: none;
}

/* Graph edges */
.edge {
  fill: none;
  stroke-width: 2;
  transition: stroke-width 0.2s;
  pointer-events: none;
}

.edge:hover {
  stroke-width: 3;
}

/* Edge type colors */
.edge-parent-child {
  stroke: var(--vscode-charts-green);
}

.edge-blocks {
  stroke: var(--vscode-charts-red);
}

.edge-blocked-by {
  stroke: var(--vscode-charts-orange);
}

/* Rubber band selection */
.selection-rectangle {
  fill: rgba(0, 120, 215, 0.1);
  stroke: #0078D7;
  stroke-width: 1;
  stroke-dasharray: 4, 2;
  pointer-events: none;
}

/* Context Menu */
.graph-context-menu {
  position: absolute;
  background-color: var(--vscode-menu-background);
  border: 1px solid var(--vscode-menu-border);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  padding: 4px 0;
  min-width: 180px;
  z-index: 1000;
  font-size: 13px;
}

.graph-context-menu.hidden {
  display: none;
}

.context-menu-item {
  padding: 6px 16px;
  cursor: pointer;
  color: var(--vscode-menu-foreground);
  transition: background-color 0.1s;
}

.context-menu-item:hover {
  background-color: var(--vscode-menu-selectionBackground);
  color: var(--vscode-menu-selectionForeground);
}

.context-menu-item.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.context-menu-item.disabled:hover {
  background-color: transparent;
  color: var(--vscode-menu-foreground);
}

.context-menu-separator {
  height: 1px;
  background-color: var(--vscode-menu-separatorBackground);
  margin: 4px 0;
}

/* Graph legend */
.graph-legend {
  position: absolute;
  bottom: 16px;
  right: 16px;
  background-color: var(--vscode-sideBar-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 12px;
  font-size: 11px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 10;
}

.graph-legend h4 {
  margin: 0 0 8px 0;
  font-size: 12px;
  font-weight: 600;
  color: var(--vscode-foreground);
}

.graph-legend-section {
  margin-bottom: 8px;
}

.graph-legend-section:last-child {
  margin-bottom: 0;
}

.graph-legend-section h5 {
  margin: 0 0 4px 0;
  font-size: 10px;
  font-weight: 600;
  color: var(--vscode-descriptionForeground);
  text-transform: uppercase;
}

.graph-legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 4px;
}

.graph-legend-item:last-child {
  margin-bottom: 0;
}

.legend-color-box {
  width: 16px;
  height: 16px;
  border-radius: 2px;
  border: 2px solid;
  opacity: 0.5;
}

.legend-color-box.status-ready,
.legend-color-box.status-open {
  background-color: #FFD700;
  border-color: #FFA500;
}

.legend-color-box.status-in_progress {
  background-color: #4CAF50;
  border-color: #388E3C;
}

.legend-color-box.status-blocked {
  background-color: #F44336;
  border-color: #D32F2F;
}

.legend-color-box.status-closed {
  background-color: #9E9E9E;
  border-color: #757575;
}

.legend-line {
  width: 24px;
  height: 2px;
  position: relative;
}

.legend-line.parent-child {
  background-color: var(--vscode-charts-green);
}

.legend-line.blocks {
  background-color: var(--vscode-charts-red);
  background-image: linear-gradient(to right, transparent 50%, var(--vscode-sideBar-background) 50%);
  background-size: 8px 2px;
}

.legend-line.blocked-by {
  background-color: var(--vscode-charts-orange);
  background-image: linear-gradient(to right, transparent 50%, var(--vscode-sideBar-background) 50%);
  background-size: 8px 2px;
}

.legend-line::after {
  content: '';
  position: absolute;
  right: -6px;
  top: -3px;
  width: 0;
  height: 0;
  border-left: 6px solid;
  border-top: 4px solid transparent;
  border-bottom: 4px solid transparent;
}

.legend-line.parent-child::after {
  border-left-color: var(--vscode-charts-green);
}

.legend-line.blocks::after {
  border-left-color: var(--vscode-charts-red);
}

.legend-line.blocked-by::after {
  border-left-color: var(--vscode-charts-orange);
}

.legend-text {
  color: var(--vscode-foreground);
  font-size: 11px;
}

/* Zoom controls */
.zoom-controls {
  position: absolute;
  top: 16px;
  right: 16px;
  display: flex;
  flex-direction: column;
  gap: 4px;
  background-color: var(--vscode-sideBar-background);
  border: 1px solid var(--vscode-panel-border);
  border-radius: 4px;
  padding: 4px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  z-index: 10;
}

.zoom-controls button {
  width: 32px;
  height: 32px;
  padding: 0;
  font-size: 16px;
  background-color: var(--vscode-button-secondaryBackground);
  color: var(--vscode-button-secondaryForeground);
  border: none;
  border-radius: 2px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.zoom-controls button:hover {
  background-color: var(--vscode-button-secondaryHoverBackground);
}

/* Focus mode indicator */
.focus-mode-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 8px;
  background-color: var(--vscode-badge-background);
  color: var(--vscode-badge-foreground);
  border-radius: 12px;
  font-size: 11px;
  font-weight: 500;
}

.focus-mode-indicator::before {
  content: 'ðŸŽ¯';
  font-size: 12px;
}

/* Graph stats */
.graph-stats {
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 11px;
  color: var(--vscode-descriptionForeground);
}

.graph-stat {
  display: flex;
  align-items: center;
  gap: 4px;
}

.graph-stat-label {
  font-weight: 500;
}

.graph-stat-value {
  color: var(--vscode-foreground);
}

/* Loading state */
.graph-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 14px;
  color: var(--vscode-descriptionForeground);
}

.graph-loading::before {
  content: '';
  width: 20px;
  height: 20px;
  margin-right: 8px;
  border: 2px solid var(--vscode-descriptionForeground);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Empty state */
.graph-empty {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  gap: 8px;
  color: var(--vscode-descriptionForeground);
}

.graph-empty-icon {
  font-size: 48px;
  opacity: 0.5;
}

.graph-empty-text {
  font-size: 14px;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .graph-sidebar {
    width: 200px;
    min-width: 200px;
  }

  .graph-controls {
    padding: 8px 12px;
    gap: 8px;
  }

  .graph-legend {
    bottom: 8px;
    right: 8px;
    padding: 8px;
    font-size: 10px;
  }

  .zoom-controls {
    top: 8px;
    right: 8px;
  }
}
